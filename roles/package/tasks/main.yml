---
- name: check {{ package_name }}
  command: '{{ check_cmd }}'
  register: package_check
  ignore_errors: yes
  changed_when: false
  check_mode: no

- name: install {{ package_name[ansible_distribution] | default(package_name.default) | default(package_name) }} | system
  ansible.builtin.package:
    name: '{{ package_name[ansible_distribution] | default(package_name.default) | default(package_name) }}'
    state: latest
  become: yes
  when: package_check.rc > 0
