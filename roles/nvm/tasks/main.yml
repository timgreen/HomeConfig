---
- block:
  - name: install nvm
    shell:
      cmd: >
        curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.1/install.sh | grep -v '>> "$NVM_PROFILE"' | bash
      creates: ~/.config/nvm/nvm.sh
      warn: false

  - name: stow nvm
    command: stow -v -t ~ -d {{ role_path }}/files -S . --no-folding
    register: output
    changed_when: '"LINK" in output.stderr'

  tags:
    nvm
